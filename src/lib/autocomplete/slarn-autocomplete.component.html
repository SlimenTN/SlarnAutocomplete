<div #container class="slarn-autocomplete-container" style="position: relative;">
    <!-- Hidden select will contain the key of the selected item -->        
    <select  
        [attr.name]="(configuration.name) ? configuration.name : null"
        [attr.multiple]="(configuration.multiple) ? 'multiple' : null">
        <ng-container *ngIf="configuration.multiple && _selectedItem != null">
            <option *ngFor="let i of _selectedItem" [value]="_selectedItem[configuration.key]" selected>
                {{_selectedItem[configuration.key]}}
            </option>
        </ng-container>
        <ng-container *ngIf="!configuration.multiple">
            <option [value]="(_selectedItem) ? _selectedItem[configuration.key] : ''" selected>
                {{(_selectedItem) ? _selectedItem[configuration.value] : '' }}
            </option>
        </ng-container>
    </select>
    
    <ng-container *ngIf="configuration.multiple && _selectedItem != null">
        <span class="selected-options" *ngFor="let i of _selectedItem">
            <span class="text">{{i[configuration.value]}}</span> <span class="remove">x</span>
        </span>
        <!-- <span class="selected-options"><span class="text">SOCIETE DES TRAVAUX MODERNES</span> <span class="remove">x</span></span>
        <span class="selected-options"><span class="text">SOPELEC</span> <span class="remove">x</span></span>
        <span class="selected-options"><span class="text">SOCIETE DES TRAVAUX MODERNES</span> <span class="remove">x</span></span>
        <span class="selected-options"><span class="text">MILANO DMCC</span> <span class="remove">x</span></span>
        <span class="selected-options"><span class="text">GOOGLE</span> <span class="remove">x</span></span> -->
    </ng-container>

    <!-- Autocomplete input will be visible to the user and contain the value -->
    <input #autocompleteInput id="ac" type="text" autocomplete="off"
        (keyup)="onKeyup($event)" (keydown)="onKeyDown($event)"
        [attr.value]="(!configuration.multiple && _selectedItem != null) ? _selectedItem[configuration.value] : null"
        [attr.placeHolder]="(configuration.placeHolder) ? configuration.placeHolder : null">
    <span #spanX style="display: none;"></span>
    <!-- Display all button -->
    <button #displayAllBtn
        class="toggle-suggestions-display"
        (click)="toggleDisplaySuggestions($event)">
    </button>

    <div class="suggestions" [style.display]="(displaySuggestions) ? 'block' : 'none'">
        <!-- Suggestions list  -->
        <slarn-ac-suggestion *ngFor="let e of filteredItems" [item]="e" (onSuggestionClicked)="performSelection($event)">
            <div [innerHTML]="buildView(e)"></div>
        </slarn-ac-suggestion>

        <!-- Displayed when no match found -->
        <div *ngIf="filteredItems != null && filteredItems.length == 0 && !loadingData"
            class="no-match-found"
            [innerHTML]="configuration.emptyListText">
        </div>

        <!--  Displayed when loading data from api -->
        <div *ngIf="loadingData"
            class="loading-data"
            [innerHTML]="configuration.loadingText">
        </div>
    </div>
</div>